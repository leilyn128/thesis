{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/layout.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { supabase } from \"../../lib/supabaseClient\";\r\n\r\nexport default function ProtectedLayout({ children }) {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const [loading, setLoading] = useState(true);\r\n  const [user, setUser] = useState(null);\r\n\r\n  const links = [\r\n    { href: \"/dashboard\", label: \"Dashboard\" },\r\n    { href: \"/transactions\", label: \"Transactions\" },\r\n    { href: \"/reports\", label: \"Reports\" },\r\n    { href: \"/settings\", label: \"Settings\" },\r\n  ];\r\n\r\n  // âœ… Run once when layout mounts\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    const checkSession = async () => {\r\n      const {\r\n        data: { session },\r\n      } = await supabase.auth.getSession();\r\n\r\n      if (!session) {\r\n        router.replace(\"/auth\");\r\n      } else if (isMounted) {\r\n        setUser(session.user);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    checkSession();\r\n\r\n    // âœ… Subscribe to auth state changes\r\n    const { data: listener } = supabase.auth.onAuthStateChange(\r\n      (_event, session) => {\r\n        if (!session) {\r\n          router.replace(\"/auth\");\r\n        } else {\r\n          setUser(session.user);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      listener.subscription.unsubscribe();\r\n    };\r\n  }, [router]);\r\n\r\n  // âœ… Show loading screen only once (not on every route change)\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-screen bg-gray-50\">\r\n        <p className=\"text-gray-500 animate-pulse\">Checking authentication...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-screen\">\r\n      {/* Sidebar */}\r\n      <aside className=\"fixed top-0 left-0 h-full w-64 bg-white shadow-lg p-6 flex flex-col justify-between\">\r\n        <div>\r\n          <div className=\"flex flex-col items-center space-y-2 mb-6\">\r\n            <img\r\n              src=\"/logo.jpg\"\r\n              alt=\"BTMS Logo\"\r\n              className=\"w-24 h-24 object-contain\"\r\n            />\r\n            <h1 className=\"text-xl font-bold text-green-700\">FUNDCAST</h1>\r\n          </div>\r\n\r\n          {/* âœ… Client-side navigation (no flicker) */}\r\n          <nav className=\"space-y-2\">\r\n            {links.map((link) => (\r\n              <Link\r\n                key={link.href}\r\n                href={link.href}\r\n                className={`block px-3 py-2 rounded-md transition ${\r\n                  pathname === link.href\r\n                    ? \"bg-green-100 text-green-700 font-semibold\"\r\n                    : \"text-gray-700 hover:bg-gray-100 hover:text-green-600\"\r\n                }`}\r\n              >\r\n                {pathname === link.href ? \"â–¸ \" : \"\"}\r\n                {link.label}\r\n              </Link>\r\n            ))}\r\n          </nav>\r\n        </div>\r\n\r\n        {/* Logout */}\r\n        <div className=\"mt-6 border-t pt-4\">\r\n          <button\r\n            onClick={async () => {\r\n              await supabase.auth.signOut();\r\n              router.replace(\"/auth\");\r\n            }}\r\n            className=\"w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 transition\"\r\n          >\r\n            ðŸšª Logout\r\n          </button>\r\n        </div>\r\n      </aside>\r\n\r\n      {/* Main content */}\r\n      <main className=\"ml-64 flex-1 h-screen overflow-y-auto p-6 bg-gray-50\">\r\n        {children}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS,gBAAgB,EAAE,QAAQ,EAAE;IAClD,MAAM,SAAS,IAAA,yJAAS;IACxB,MAAM,WAAW,IAAA,2JAAW;IAC5B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2NAAQ,EAAC;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,2NAAQ,EAAC;IAEjC,MAAM,QAAQ;QACZ;YAAE,MAAM;YAAc,OAAO;QAAY;QACzC;YAAE,MAAM;YAAiB,OAAO;QAAe;QAC/C;YAAE,MAAM;YAAY,OAAO;QAAU;QACrC;YAAE,MAAM;YAAa,OAAO;QAAW;KACxC;IAED,gCAAgC;IAChC,IAAA,4NAAS,EAAC;QACR,IAAI,YAAY;QAEhB,MAAM,eAAe;YACnB,MAAM,EACJ,MAAM,EAAE,OAAO,EAAE,EAClB,GAAG,MAAM,2IAAQ,CAAC,IAAI,CAAC,UAAU;YAElC,IAAI,CAAC,SAAS;gBACZ,OAAO,OAAO,CAAC;YACjB,OAAO,IAAI,WAAW;gBACpB,QAAQ,QAAQ,IAAI;gBACpB,WAAW;YACb;QACF;QAEA;QAEA,oCAAoC;QACpC,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,2IAAQ,CAAC,IAAI,CAAC,iBAAiB,CACxD,CAAC,QAAQ;YACP,IAAI,CAAC,SAAS;gBACZ,OAAO,OAAO,CAAC;YACjB,OAAO;gBACL,QAAQ,QAAQ,IAAI;YACtB;QACF;QAGF,OAAO;YACL,YAAY;YACZ,SAAS,YAAY,CAAC,WAAW;QACnC;IACF,GAAG;QAAC;KAAO;IAEX,8DAA8D;IAC9D,IAAI,SAAS;QACX,qBACE,wPAAC;YAAI,WAAU;sBACb,cAAA,wPAAC;gBAAE,WAAU;0BAA8B;;;;;;;;;;;IAGjD;IAEA,qBACE,wPAAC;QAAI,WAAU;;0BAEb,wPAAC;gBAAM,WAAU;;kCACf,wPAAC;;0CACC,wPAAC;gCAAI,WAAU;;kDACb,wPAAC;wCACC,KAAI;wCACJ,KAAI;wCACJ,WAAU;;;;;;kDAEZ,wPAAC;wCAAG,WAAU;kDAAmC;;;;;;;;;;;;0CAInD,wPAAC;gCAAI,WAAU;0CACZ,MAAM,GAAG,CAAC,CAAC,qBACV,wPAAC,iLAAI;wCAEH,MAAM,KAAK,IAAI;wCACf,WAAW,CAAC,sCAAsC,EAChD,aAAa,KAAK,IAAI,GAClB,8CACA,wDACJ;;4CAED,aAAa,KAAK,IAAI,GAAG,OAAO;4CAChC,KAAK,KAAK;;uCATN,KAAK,IAAI;;;;;;;;;;;;;;;;kCAgBtB,wPAAC;wBAAI,WAAU;kCACb,cAAA,wPAAC;4BACC,SAAS;gCACP,MAAM,2IAAQ,CAAC,IAAI,CAAC,OAAO;gCAC3B,OAAO,OAAO,CAAC;4BACjB;4BACA,WAAU;sCACX;;;;;;;;;;;;;;;;;0BAOL,wPAAC;gBAAK,WAAU;0BACb;;;;;;;;;;;;AAIT","debugId":null}}]
}