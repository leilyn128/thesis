{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/components/ui/card.jsx"],"sourcesContent":["export function Card({ children }) {\r\n  return <div className=\"bg-white rounded-xl shadow\">{children}</div>\r\n}\r\n\r\nexport function CardContent({ children, className }) {\r\n  return <div className={className}>{children}</div>\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAO,SAAS,KAAK,KAAY;QAAZ,EAAE,QAAQ,EAAE,GAAZ;IACnB,qBAAO,uMAAC;QAAI,WAAU;kBAA8B;;;;;;AACtD;KAFgB;AAIT,SAAS,YAAY,KAAuB;QAAvB,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAvB;IAC1B,qBAAO,uMAAC;QAAI,WAAW;kBAAY;;;;;;AACrC;MAFgB","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/dashboard/page.jsx"],"sourcesContent":["\"use client\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { supabase } from \"../../../lib/supabaseClient\"\r\nimport { LineChart, Line, XAxis, YAxis, Tooltip, CartesianGrid, ResponsiveContainer } from \"recharts\"\r\nimport { Card, CardContent } from \"../../../components/ui/card\"\r\n\r\nexport default function DashboardPage() {\r\n  const [iraData, setIraData] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    fetchIRA()\r\n  }, [])\r\n\r\n  async function fetchIRA() {\r\n    setLoading(true)\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"trial_balance\")\r\n        .select(\"account_name, debit, credit, year\")\r\n\r\n      if (error) throw error\r\n\r\n      // üß© Define possible IRA/NTA account name keywords\r\n      const iraKeywords = [\r\n        \"share from internal revenue collections\", // exact barangay IRA name\r\n        \"ira\",\r\n        \"internal revenue\",\r\n        \"nta\",\r\n        \"national tax\",\r\n      ]\r\n\r\n      // üß† Filter IRA/NTA entries based on keywords\r\n      const iraEntries = data.filter(row =>\r\n        iraKeywords.some(keyword =>\r\n          row.account_name?.toLowerCase().includes(keyword)\r\n        )\r\n      )\r\n\r\n      // üßæ Sum total IRA by year\r\n      const yearlyTotals = {}\r\n      iraEntries.forEach(row => {\r\n        // ensure year is number\r\n        const year = Number(row.year)\r\n        if (!year || isNaN(year)) return\r\n\r\n        const amount = (parseFloat(row.debit) || 0) - (parseFloat(row.credit) || 0)\r\n        yearlyTotals[year] = (yearlyTotals[year] || 0) + amount\r\n      })\r\n\r\n      // ‚úÖ Sort years numerically (so 2024 won‚Äôt be skipped)\r\n      const sortedYears = Object.keys(yearlyTotals)\r\n        .map(y => Number(y))\r\n        .sort((a, b) => a - b)\r\n\r\n      // üßÆ Format data for the chart\r\n      const formatted = sortedYears.map(year => ({\r\n        year,\r\n        ira: yearlyTotals[year],\r\n      }))\r\n\r\n      setIraData(formatted)\r\n    } catch (err) {\r\n      console.error(\"Error fetching IRA data:\", err)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  if (loading) return <p>Loading IRA data...</p>\r\n\r\n  // üßÆ Derived stats\r\n  const lastYear = iraData[iraData.length - 1]?.year || \"N/A\"\r\n  const lastIra = iraData[iraData.length - 1]?.ira || 0\r\n  const prevIra = iraData[iraData.length - 2]?.ira || 0\r\n  const growthRate = prevIra ? (((lastIra - prevIra) / prevIra) * 100).toFixed(2) : \"0\"\r\n\r\n  return (\r\n    <div className=\"space-y-6 p-6\">\r\n      {/* üè∑ Header */}\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-800\">IRA / NTA Overview</h2>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Historical trend and yearly growth based on ‚ÄúShare from Internal Revenue Collections‚Äù\r\n        </p>\r\n      </div>\r\n\r\n      {/* üìä KPI / Observations */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <h2 className=\"text-sm text-gray-500\">Latest IRA ({lastYear})</h2>\r\n            <p className=\"text-2xl font-bold text-indigo-600\">\r\n              ‚Ç±{lastIra.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <h2 className=\"text-sm text-gray-500\">Previous Year</h2>\r\n            <p className=\"text-2xl font-bold\">\r\n              ‚Ç±{prevIra.toLocaleString()}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <h2 className=\"text-sm text-gray-500\">Growth Rate</h2>\r\n            <p\r\n              className={`text-2xl font-bold ${\r\n                growthRate >= 0 ? \"text-green-600\" : \"text-red-600\"\r\n              }`}\r\n            >\r\n              {growthRate}%\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* üìà IRA Trend Chart */}\r\n      <div className=\"bg-white rounded-xl shadow p-4 h-96\">\r\n        <h2 className=\"text-lg font-semibold mb-4\">\r\n          IRA / NTA Trend ({iraData[0]?.year}‚Äì{lastYear})\r\n        </h2>\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <LineChart data={iraData}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            <XAxis dataKey=\"year\" />\r\n            <YAxis />\r\n            <Tooltip\r\n              formatter={(value) =>\r\n                new Intl.NumberFormat(\"en-PH\", {\r\n                  style: \"currency\",\r\n                  currency: \"PHP\",\r\n                }).format(value)\r\n              }\r\n            />\r\n            <Line type=\"monotone\" dataKey=\"ira\" stroke=\"#4F46E5\" strokeWidth={3} />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}